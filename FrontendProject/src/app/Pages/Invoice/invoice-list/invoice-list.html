<div class="Invoice-container">
  <h2>Invoice Summary</h2>

  <div class="tab-container">
    <button class="tab-button" 
            [class.active]="showActive" 
            (click)="toggleFilter(true)">Active Invoices</button>
    <button class="tab-button" 
            [class.active]="!showActive" 
            (click)="toggleFilter(false)">Inactive Invoices</button>
  </div>

  <div class="button-container-right" style="margin-bottom: 1rem;">
    <button (click)="goToADDInvoices()">ADD Invoices</button>
  </div>
  <div class="search-container" style="margin-bottom: 1rem;">
    <input type="text" placeholder="Search by Invoice No or Customer Name" [(ngModel)]="searchTerm" (input)="applyFilter()"/>
  </div>

  <div class="table-container">
    <table class="invoice-table">
      <thead>
        <tr>
          <th>Invoice No</th>
          <th>Customer Name</th>    
          <th>Invoice Date</th>
          <th>Quantity</th>
          <th>Amount</th>
          <th>Created By</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let inv of filteredInvoices" (click)="selectInvoice(inv)" style="cursor: pointer;">
          <td>{{ inv.invoiceNo }}</td>
          <td>{{ inv.cusName }}</td>
          <td>{{ inv.invoiceDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ inv.totalQty }}</td>
          <td>{{ inv.totalAmount |  currency:'LKR. ':'symbol':'1.2-2' }}</td>
          <td>{{ inv.createdBy }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="modal" *ngIf="selectedInvoice">
    <div class="modal-content">
      <span class="close-btn" (click)="closeModal()">&times;</span>

      <h3>Invoice Details - {{ selectedInvoice.invoiceNo }}</h3>
      <p><strong>Customer:</strong> {{ selectedInvoice.cusName }}</p>
      <p><strong>Date:</strong> {{ selectedInvoice.invoiceDate | date:'yyyy-MM-dd' }}</p>
      <p><strong>Total Quantity:</strong> {{ selectedInvoice.totalQty }}</p>
      <p><strong>Total Amount:</strong> {{ selectedInvoice.totalAmount | currency:'LKR. ':'symbol':'1.2-2' }}</p>

      <h4>Invoice Items</h4>
      <table class="items-table" *ngIf="invoiceItems && invoiceItems.length > 0; else noItems">
        <thead>
          <tr>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of invoiceItems">
            <td>{{ item.itemName }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.price | currency:'LKR. ':'symbol':'1.2-2' }}</td>
            <td>{{ (item.quantity * item.price) | currency:'LKR. ':'symbol':'1.2-2' }}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noItems>
        <p>No items found for this invoice.</p>
      </ng-template>
    <div class="button-container-right" *ngIf="showActive">
      <button (click)="deleteInvoices()">Delete</button>
    </div>
    </div>
  </div>
</div>
